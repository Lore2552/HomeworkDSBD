{
	"info": {
		"_postman_id": "b5a6c7d8-e9f0-1a2b-3c4d-5e6f7a8b9c0d",
		"name": "User Manager API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Add User",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"message_id\": \"{{$uuid}}\",\n  \"email\": \"mario.rossi@example.com\",\n  \"name\": \"Mario\",\n  \"surname\": \"Rossi\",\n  \"fiscal_code\": \"RSSMRA80A01H501Z\",\n  \"bank_info\": \"IT000000000000000000000000\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/addUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"addUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get All Users",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
				"raw": "http://localhost:5000/users",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"users"
					]
				}
			},
			"response": []
		},
		{
			"name": "Delete User",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"mario.rossi@example.com\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/deleteUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"deleteUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Token",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/get_token",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"get_token"
					]
				}
			},
			"response": []
		},
		{
			"name": "Register Airports",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"mario.rossi@example.com\",\n  \"airports\": [\"LIRF\", \"LIMC\"]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5001/register_airports",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"register_airports"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get User Info",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/user_info/mario.rossi@example.com",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"user_info",
						"mario.rossi@example.com"
					]
				}
			},
			"response": []
		},
		{
			"name": "Trigger Flight Collection",
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/collect_flights",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"collect_flights"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Collected Flights",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/flights",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"flights"
					]
				}
			},
			"response": []
		},
		{
			"name": "Add User (Luigi)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"message_id\": \"{{$uuid}}\",\n  \"email\": \"luigi.verdi@example.com\",\n  \"name\": \"Luigi\",\n  \"surname\": \"Verdi\",\n  \"fiscal_code\": \"VRDLGU80A01H501Z\",\n  \"bank_info\": \"IT000000000000000000000001\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/addUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"addUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Register Airports (Luigi) - Auto Collect",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"luigi.verdi@example.com\",\n  \"airports\": [\"KJFK\", \"EGLL\"]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5001/register_airports",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"register_airports"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Last Flight (LIRF)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/airports/LIRF/last_flight",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"airports",
						"LIRF",
						"last_flight"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Average Flights (LIRF - 7 days)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/airports/LIRF/average_flights?days=7",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"airports",
						"LIRF",
						"average_flights"
					],
					"query": [
						{
							"key": "days",
							"value": "7"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Busiest Hour (LIRF)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/airports/LIRF/busiest_hour",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"airports",
						"LIRF",
						"busiest_hour"
					]
				}
			},
			"response": []
		},
		{
			"name": "Add User (Giovanni - Duplicate Prefs Test)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"message_id\": \"{{$uuid}}\",\n  \"email\": \"giovanni.bianchi@example.com\",\n  \"name\": \"Giovanni\",\n  \"surname\": \"Bianchi\",\n  \"fiscal_code\": \"BNCGNN80A01H501Z\",\n  \"bank_info\": \"IT000000000000000000000002\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/addUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"addUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Register Airports (Giovanni) - Duplicate LIRF/LIMC",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"giovanni.bianchi@example.com\",\n  \"airports\": [\"LIRF\", \"LIMC\"]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5001/register_airports",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"register_airports"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verify Cleanup (Giovanni)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/user_info/giovanni.bianchi@example.com",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"user_info",
						"giovanni.bianchi@example.com"
					]
				}
			},
			"response": []
		},
		{
			"name": "Remove Airport Interest (Mario - LIRF)",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"mario.rossi@example.com\",\n  \"airport_code\": \"LIRF\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/removeAirportInterest",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"removeAirportInterest"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verify Airport Removal (Mario)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5001/user_info/mario.rossi@example.com",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5001",
					"path": [
						"user_info",
						"mario.rossi@example.com"
					]
				}
			},
			"response": []
		},
		{
			"name": "Remove Last Airport Interest (Mario - LIMC, should delete flights)",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"mario.rossi@example.com\",\n  \"airport_code\": \"LIMC\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/removeAirportInterest",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"removeAirportInterest"
					]
				}
			},
			"response": []
		},
		{
			"name": "Remove Shared Airport Interest (Giovanni - LIRF, should NOT delete flights)",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"giovanni.bianchi@example.com\",\n  \"airport_code\": \"LIRF\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/removeAirportInterest",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"removeAirportInterest"
					]
				}
			},
			"response": []
		},
		{
			"name": "Add User - Duplicate Message (should fail)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"message_id\": \"Usa lo stesso UUID generato dal primo 'Add User' per Mario - copia il valore dal body della risposta precedente\",\n  \"email\": \"mario.rossi@example.com\",\n  \"name\": \"Mario\",\n  \"surname\": \"Rossi\",\n  \"fiscal_code\": \"RSSMRA80A01H501Z\",\n  \"bank_info\": \"IT000000000000000000000000\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/addUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"addUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Add User (Franco - New User with different UUID)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"message_id\": \"{{$uuid}}\",\n  \"email\": \"franco.neri@example.com\",\n  \"name\": \"Franco\",\n  \"surname\": \"Neri\",\n  \"fiscal_code\": \"NRFRNC80A01H501Z\",\n  \"bank_info\": \"IT000000000000000000000003\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "http://localhost:5000/addUser",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"addUser"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verify Franco was added (At Most Once works)",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://localhost:5000/users",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "5000",
					"path": [
						"users"
					]
				}
			},
			"response": []
		}
	]
}
